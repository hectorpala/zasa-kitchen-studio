// Zasa Kitchen Studio - v4.1 ULTRA-OPTIMIZED (107 KiB JS reduction target)
// Core functionality only - Performance First
(function(){"use strict";let webpSupport=false;

// Minimal task yielding
function yieldToMain(){return new Promise(r=>setTimeout(r,0));}

// WebP detection - simplified
async function supportsWebP(){return new Promise(r=>{const w=new Image();w.onload=w.onerror=()=>r(w.height===2);w.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";});}

// Minimal navigation
function initNav(){const h=document.getElementById("hamburger"),n=document.getElementById("mainNav");if(h&&n){h.onclick=()=>{h.classList.toggle("active");n.classList.toggle("active");document.body.style.overflow=n.classList.contains("active")?"hidden":"auto";};n.querySelectorAll(".nav-link").forEach(l=>l.onclick=()=>{h.classList.remove("active");n.classList.remove("active");document.body.style.overflow="auto";});}}

// Simple scroll navbar
let scrolling=false;function initScroll(){const nav=document.querySelector(".navbar");window.addEventListener("scroll",()=>{if(!scrolling){requestAnimationFrame(()=>{nav&&nav.classList.toggle("scrolled",window.scrollY>100);scrolling=false;});scrolling=true;}},{passive:true});}

// Essential lazy loading only
function initLazy(){const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){const img=entry.target;if(img.dataset.src){img.src=img.dataset.src;img.removeAttribute("data-src");}if(img.dataset.srcset){img.srcset=img.dataset.srcset;img.removeAttribute("data-srcset");}img.classList.add("lazyloaded");observer.unobserve(img);}});},{rootMargin:"50px"});document.querySelectorAll("img[data-src]").forEach(img=>observer.observe(img));}

// Minimal analytics
function initAnalytics(){document.querySelectorAll('a[href*="wa.me"]').forEach(l=>l.onclick=()=>typeof gtag!=="undefined"&&gtag("event","whatsapp_click"));}

// Ultra-fast initialization - LCP priority
document.addEventListener("DOMContentLoaded",async function(){
webpSupport=await supportsWebP();
initNav();
initScroll();
requestIdleCallback(()=>{initLazy();initAnalytics();document.body.classList.add("fonts-loaded");});
});

})();